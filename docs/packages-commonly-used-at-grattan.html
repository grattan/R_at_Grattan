<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>6 Packages commonly used at Grattan | Using R at Grattan Institute</title>
<meta name="author" content="Matt Cowgill, Will Mackey, and James Ha">
<meta name="description" content="Some packages we use at Grattan - like the tidyverse collection of packages - are very popular among R users. Some - like the grattantheme package - are specific to Grattan Institute. Others -...">
<meta name="generator" content="bookdown 0.23.1 with bs4_book()">
<meta property="og:title" content="6 Packages commonly used at Grattan | Using R at Grattan Institute">
<meta property="og:type" content="book">
<meta property="og:description" content="Some packages we use at Grattan - like the tidyverse collection of packages - are very popular among R users. Some - like the grattantheme package - are specific to Grattan Institute. Others -...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6 Packages commonly used at Grattan | Using R at Grattan Institute">
<meta name="twitter:description" content="Some packages we use at Grattan - like the tidyverse collection of packages - are very popular among R users. Some - like the grattantheme package - are specific to Grattan Institute. Others -...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Roboto-0.4.0/font.css" rel="stylesheet">
<link href="libs/_Roboto%20Mono-0.4.0/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Using R at Grattan Institute</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li class="book-part">What is R and why do we use it?</li>
<li><a class="" href="introduction-to-r.html"><span class="header-section-number">1</span> Introduction to R</a></li>
<li><a class="" href="why-use-r.html"><span class="header-section-number">2</span> Why use R?</a></li>
<li class="book-part">Using R the Grattan way</li>
<li><a class="" href="organising-projects.html"><span class="header-section-number">3</span> Organising an R project at Grattan</a></li>
<li><a class="" href="coding-style.html"><span class="header-section-number">4</span> Grattan coding style</a></li>
<li><a class="" href="packages.html"><span class="header-section-number">5</span> What are packages?</a></li>
<li><a class="active" href="packages-commonly-used-at-grattan.html"><span class="header-section-number">6</span> Packages commonly used at Grattan</a></li>
<li><a class="" href="getting-help-with-r.html"><span class="header-section-number">7</span> Getting help with R</a></li>
<li class="book-part">Load, manipulate and visualise data</li>
<li><a class="" href="reading-data.html"><span class="header-section-number">8</span> Reading data</a></li>
<li><a class="" href="different-data-types.html"><span class="header-section-number">9</span> Different data types</a></li>
<li><a class="" href="data-transformation-with-dplyr.html"><span class="header-section-number">10</span> Data transformation with dplyr</a></li>
<li><a class="" href="analysis.html"><span class="header-section-number">11</span> Analysis</a></li>
<li><a class="" href="data-visualisation.html"><span class="header-section-number">12</span> Data Visualisation</a></li>
<li><a class="" href="chart-cookbook.html"><span class="header-section-number">13</span> Chart cookbook</a></li>
<li class="book-part">Advanced topics</li>
<li><a class="" href="functional-programming-making-and-using-your-own-functions.html"><span class="header-section-number">14</span> Functional programming: making and using your own functions</a></li>
<li><a class="" href="version-control.html"><span class="header-section-number">15</span> Version control</a></li>
<li><a class="" href="contributing-to-this-book.html"><span class="header-section-number">16</span> Contributing to this book</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="packages-commonly-used-at-grattan" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Packages commonly used at Grattan<a class="anchor" aria-label="anchor" href="#packages-commonly-used-at-grattan"><i class="fas fa-link"></i></a>
</h1>
<p>Some packages we use at Grattan - like the <code>tidyverse</code> collection of packages - are very popular among R users. Some - like the <code>grattantheme</code> package - are specific to Grattan Institute. Others - like the <code>readabs</code> package - are made by Grattan people, useful at Grattan, but also used outside of the Institute. To install a core set of packages we use at Grattan, <a href="packages.html#install-grattan-packages">click here and run the code chunk</a>.</p>
<div id="tidyverse" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> The tidyverse!<a class="anchor" aria-label="anchor" href="#tidyverse"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>tidyverse</code> is central to our work at Grattan. The <code>tidyverse</code> is a <a href="https://www.tidyverse.org/packages/">collection of related R packages</a> for importing, wrangling, exploring and visualising data in R. The packages are designed to work well together.
The main packages in the <code>tidyverse</code> include:</p>
<ul>
<li>
<em>ggplot2</em> for making beautiful, customisable graphs</li>
<li>
<em>dplyr</em> for manipulating data frames</li>
<li>
<em>tidyr</em> for tidying your data</li>
<li>
<em>readr</em> for importing data from a broad range of formats</li>
<li>
<em>purrr</em> for functional programming</li>
<li>
<em>stringr</em> for manipulating strings of text</li>
</ul>
<p>All these packages (and more!) will automatically be loaded for you when you run the command<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;There’s no need to install or load the individual &lt;code&gt;tidyverse&lt;/code&gt; packages - like &lt;code&gt;dplyr&lt;/code&gt; - separately. Just install them all together, and load them with the single &lt;code&gt;library(tidyverse)&lt;/code&gt; command. That way, you don’t need to remember which functions come from &lt;code&gt;tidyr&lt;/code&gt; and which from &lt;code&gt;dplyr&lt;/code&gt; - they’re all just &lt;code&gt;tidyverse&lt;/code&gt; functions.&lt;/p&gt;"><sup>8</sup></a>:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<p>A range of other packages are installed on your machine as part of the <code>tidyverse.</code> These include:</p>
<ul>
<li>
<em>readxl</em> for importing Excel spreadsheets into R</li>
<li>
<em>haven</em> for importing Stata, SAS and SPSS data</li>
<li>
<em>lubridate</em> for working with dates</li>
<li>
<em>rvest</em> for scraping websites</li>
</ul>
<p>Although these packages are installed as part of the <code>tidyverse</code>, they aren’t loaded automatically when you run <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>. You’ll need to load them individually, like:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></code></pre></div>
<div id="why-do-we-use-the-tidyverse" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Why do we use the tidyverse?<a class="anchor" aria-label="anchor" href="#why-do-we-use-the-tidyverse"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>tidyverse</code> makes life easier!</p>
<p>The core <code>tidyverse</code> packages, like <code>ggplot2</code>, <code>dplyr</code>, and <code>tidyr</code>, are extremely popular. The <code>tidyverse</code> is probably the most popular ‘dialect’ of R. This means that any problem you encounter with the <code>tidyverse</code> will have been encountered many times before by other R users, so a solution will only be a Google search away.</p>
<p>The <code>tidyverse</code> packages are all designed to work well together, with a consistent underlying philosophy and design. This means that coding habits you learn with one <code>tidyverse</code> package, like <code>dplyr</code>, are also applicable to other packages, like <code>tidyr</code>.</p>
<p>They’re designed to work with data frames<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The tidyverse works with ‘tibbles,’ which are a tidyverse-specific variant of the data frame. Don’t worry about the difference between tibbles and data frames.&lt;/p&gt;"><sup>9</sup></a>, a rectangular data object that will be familiar to spreadsheet users that is very intuitive and convenient for the sort of work we do at Grattan. In particular, the <code>tidyverse</code> is built around the concept of <a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html"><em>tidy data</em></a>, which has a specific meaning in this context that we’ll come to later. The fact that <code>tidyverse</code> packages are all built around one type of data object makes them easier to work with.</p>
<p>The creator of the <code>tidyverse</code>, Hadley Wickham, places great value on code that is expressive and comprehensible to humans. This means that code written in the <code>tidyverse</code> idiom is often able to be understood even if you haven’t encountered the functions before. For example, look at this chunk of code:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>relative_income <span class="op">=</span> <span class="va">income</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Without knowing what <code>my_data</code> looks like, and even if you haven’t encountered these functions before, this should be reasonably intuitive. We’re taking some data, and then<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;you can read the pipe, &lt;code&gt;%&amp;gt;%&lt;/code&gt;, as ‘and then’&lt;/p&gt;"><sup>10</sup></a> only keeping observations that relate to people aged 30 and older, then calculating a new variable, <code>relative_income</code>. The name of a <code>tidyverse</code> function - like <code>filter</code>, <code>group_by</code>, <code>summarise</code>, and so on - generally gives you a pretty good idea what the function is going to do with your data, which isn’t always the case with other approaches.</p>
<p>Here’s one way to do the same thing in base R:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">[</span><span class="va">my_data</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">30</span>, <span class="op">]</span>,
          relative_income <span class="op">=</span> <span class="va">income</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The base R code gets the job done, but it’s clunkier, less expressive, and harder to read. A core principle of coding at Grattan is that you should strive to make your work <strong>human readable</strong>.</p>
<p>Code written with <code>tidyverse</code> functions is often faster than its base R equivalents. But most of our work at Grattan is with small-to-medium sized datasets (with fewer than a million rows or so), so speed isn’t usually a major concern anyway.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;When working with very large datasets, it might be worth gaining speed using other packages, such as &lt;a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html"&gt;&lt;code&gt;data.table&lt;/code&gt;&lt;/a&gt;. Fortunately, using the &lt;code&gt;dtplyr&lt;/code&gt; package you can get most of the speed benefits of &lt;code&gt;data.table&lt;/code&gt; and stick to familiar &lt;code&gt;dplyr&lt;/code&gt; syntax.&lt;/p&gt;'><sup>11</sup></a></p>
<p>The most valuable resource we deal with at Grattan is our time. Computers are cheap, people are not. If your code executes quickly, but it takes your colleague many hours to decipher it, the cost of the extra QC time more than outweighs the saving through faster computation. The <code>tidyverse</code> packages strike a balance between expressive, comprehensible code and computational efficiency that suits the nature of our work at Grattan. This balance is the right one for most of our work, most of the time.</p>
<p>Most R scripts at Grattan should start with <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>. Most of your work will be in data frames, and most of the time the <code>tidyverse</code> contains the core tools you’ll need to do that work.</p>
</div>
</div>
<div id="grattan-specific-packages" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Grattan-specific packages<a class="anchor" aria-label="anchor" href="#grattan-specific-packages"><i class="fas fa-link"></i></a>
</h2>
<p>A range of Grattan people have written packages that come in handy at Grattan.
* <em>grattantheme</em> The <code>grattantheme</code> package, by Matt Cowgill and Will Mackey, helps to make your ggplot2 charts Grattan-y. We cover the package extensively in the data visualisation chapter.</p>
<ul>
<li><p><em>grattandata</em> The <code>grattandata</code> package, by Matt Cowgill and Jonathan Nolan, is used to load microdata from the Grattan microdata repository. We cover this in the <a href="reading-data.html#reading-data">reading data</a> chapter.</p></li>
<li><p><em>grattan</em> The <code>grattan</code> package, created by Hugh Parsonage, contains two broad sets of functions. One set of functions (sometimes known by the nickname “Grattax”) is used for modelling the personal income tax system. Another set of functions (“Grattools”) are useful for a lot of our work, like converting dates to financial years (<code><a href="https://hughparsonage.github.io/grattan/reference/is.fy.html">grattan::date2fy()</a></code>) or a version of <code><a href="https://dplyr.tidyverse.org/reference/ranking.html">dplyr::ntile()</a></code> that uses weights (<code><a href="https://hughparsonage.github.io/hutils/reference/weighted_ntile.html">grattan::weighted_ntile()</a></code>).</p></li>
</ul>
</div>
<div id="other-commonly-used-packages" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Other commonly-used packages<a class="anchor" aria-label="anchor" href="#other-commonly-used-packages"><i class="fas fa-link"></i></a>
</h2>
<p>There are other packages we commonly use at Grattan, including some developed by Grattan staff. These include:</p>
<ul>
<li><p><em>absmapsdata</em> This package, by Will Mackey, is very handy for working with spatial data. You’ll want it if you’re going to be making maps.</p></li>
<li><p><em>readabs</em> The <code>readabs</code> package, by Matt Cowgill, provides an easy way to download, tidy, and import ABS time series data in R.</p></li>
</ul>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="packages.html"><span class="header-section-number">5</span> What are packages?</a></div>
<div class="next"><a href="getting-help-with-r.html"><span class="header-section-number">7</span> Getting help with R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#packages-commonly-used-at-grattan"><span class="header-section-number">6</span> Packages commonly used at Grattan</a></li>
<li>
<a class="nav-link" href="#tidyverse"><span class="header-section-number">6.1</span> The tidyverse!</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#why-do-we-use-the-tidyverse"><span class="header-section-number">6.1.1</span> Why do we use the tidyverse?</a></li></ul>
</li>
<li><a class="nav-link" href="#grattan-specific-packages"><span class="header-section-number">6.2</span> Grattan-specific packages</a></li>
<li><a class="nav-link" href="#other-commonly-used-packages"><span class="header-section-number">6.3</span> Other commonly-used packages</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Using R at Grattan Institute</strong>" was written by Matt Cowgill, Will Mackey, and James Ha. It was last built on 2021-12-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
